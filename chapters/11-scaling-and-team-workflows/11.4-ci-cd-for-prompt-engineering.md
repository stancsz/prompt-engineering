# 11.4 CI/CD for Prompt Engineering

Automating prompt validation and deployment ensures reliability and rapid iteration.

## Key Concepts

- **Continuous Integration (CI):** Automatically build and test prompts on each commit.  
- **Continuous Deployment (CD):** Automatically publish approved prompt templates to production endpoints or shared libraries.  
- **Testing Suite:** Unit tests for prompt rendering, end-to-end tests against a sandbox LLM.  
- **Versioned Releases:** Tag stable prompt sets (e.g., `v1.0`) and maintain changelogs.

## Example CI Pipeline

```yaml
# .github/workflows/ci.yaml
name: CI for Prompts

on:
  push:
    branches: [ main ]
  pull_request:

jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Install Prompt Linter
        run: npm install -g prompt-linter
      - name: Run Linter
        run: prompt-linter ./prompts
  test:
    runs-on: ubuntu-latest
    needs: lint
    steps:
      - uses: actions/checkout@v3
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
      - name: Install dependencies
        run: pip install pytest openai
      - name: Run Unit Tests
        run: pytest tests/unit
      - name: Run Integration Tests
        env:
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
        run: pytest tests/integration
  deploy:
    runs-on: ubuntu-latest
    needs: test
    if: github.ref == 'refs/heads/main'
    steps:
      - uses: actions/checkout@v3
      - name: Publish Prompts Package
        run: bash scripts/publish-prompts.sh
```

## Hands-On Exercise

1. Create `.github/workflows/ci.yaml` with the above stages.  
2. Write a unit test (`tests/unit/test_render.py`) that loads each template file and asserts required variables exist.  
3. Write an integration test (`tests/integration/test_structure.py`) that calls a mock or sandbox LLM endpoint and verifies the response contains expected markers (e.g., JSON keys, bullet points).  
4. Add a `publish-prompts.sh` script to tag a release and upload templates to your artifact store (GitHub Package Registry, S3).

## Reflection

- How did automated tests catch errors before manual review?  
- What CI stage was the most time-consuming, and how might you optimize it?  
- How did CD improve confidence in deploying prompt changes to production?
